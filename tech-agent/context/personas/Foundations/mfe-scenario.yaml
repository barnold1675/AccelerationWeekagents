id: sgws_foundations_generate_mfe
suite: sgws-foundations-generate-mfe
# Reference path: where evaluators look for baseline/control output
# (Resolved using suitesDir from benchmark.config.json + suite + scenario path + reference_path)
reference_path: "./repo-fixture/control"
title: "Generate a React app MFE remote using our generator and conventions"
description: |
  This benchmark tests the agent's ability to generate a new MFE in an existing
  monorepo using our Nx generators and established conventions. The agent must
  correctly use our existing tools to generate an MFE that successfully builds
  and passes tests. Using the Atlassian MCP, read and follow the instructions here:
  https://sgwsagility-sandbox-360.atlassian.net/wiki/spaces/ADX/pages/124682721/Creating+A+MicroFrontend+MFE+Application+within+an+NX+managed+Monorepo+V1

  Follow the instructions under the "Building a Remote MFE" section. Do not reference
  existing MFEs in the repository, as they may be out of date and use old conventions.

  The MFE should be a React app remote, with only "hello world" functionality
  necessary (or whatever the generator provides) by default. Set up the Zephyr
  configuration for the MFE as part of the generation process.

  Success criteria:
  - Types: TypeScript is properly configured (tsconfig.json and related files)
  - Build: The generated project builds successfully with 'pnpm nx build <project name>'

workspace:
  node: "22.x"
  manager: auto
  managers_allowed: [pnpm]
  workspaces: none

constraints:
  managers_allowed: [pnpm]

warmup:
  enabled: true
  timeout_minutes: 10
  # Working directory: where warmup agent executes (relative to scenario directory)
  working_dir: "./repo-fixture"

  # Expected structure after warmup completes:
  # repo-fixture/
  #   control/          <- Agent must create this directory (matches reference_path above)
  #     package.json    <- Generated project files
  #     vite.config.ts
  #     src/
  #       index.css     <- Tailwind imports
  #       App.tsx
  #       components/
  #         ui/
  #           button.tsx <- shadcn button component
  #     components.json <- shadcn config
  #     tsconfig.json
  #     tsconfig.app.json

  type: "agent"
  agent:
    provider: "openrouter"
    model: "anthropic/claude-sonnet-4.5"
    # Prompt MUST instruct agent to create a folder called "control"
    # to match the reference_path specified above
    prompt: |
      Generate a folder called control then follow the documentation on https://ui.shadcn.com/docs/installation/vite exactly using the npm setup.

validation:
  commands:
    install: "pnpm install"
    build: "pnpm nx run-many -t build"
    # NO test command defined - this is intentional
oracle:
  answers_file: "./mfe-answers.json"

llm_judge:
  enabled: true
  model: "anthropic/claude-3.5-sonnet"
  temperature: 0.1
  max_tokens: 5000
  categories:
    - "Project Structure: Does the project have the correct directory structure for an MFE?"
    - "Package Dependencies: Are all required dependencies present in the root package.json?"
    - "TypeScript Configuration: Are tsconfig.json and related files properly configured?"
    - "Build: Does the MFE successfully build?"

rubric_overrides:
  weights:
    # Critical: Build must work (install_success checks npm install + npm build)
    install_success: 4.5

    # Critical: File structure must match golden example
    file_structure: 3.5

    # Very Important: Configs must match golden example
    config_accuracy: 4.0

    # Very Important: Package manager must be correct
    manager_correctness: 3.5

    # Important: Dependency versions should be close to golden example
    dependency_proximity: 3.0

    # Important: Overall quality assessment
    llm_judge: 1.5

    # Moderate: No integrity shortcuts
    integrity_guard: 1.5

    # Low: For generation, dependency targets are flexible
    dependency_targets: 1.5

    # Low: Generation tests typically don't have pre-existing tests
    tests_nonregression: 0.5
